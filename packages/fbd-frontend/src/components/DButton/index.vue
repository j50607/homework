<template>
  <button
    class="d-btn"
    :class="[
      `d-btn-${type}`,
      {'disabled': disabled},
      {'loading': loading},
      {'block': block},
      {'border-none': !border},
      {'round': round},
      `style${siteStyle}`
    ]"
    :style="{'--custom-bg': color, '--custom-color': textColor}"
    @click="click"
  >
    <LoadingOutlined v-if="loading" />
    <span>
      <slot />
    </span>
  </button>
</template>

<script>
import { LoadingOutlined } from '@ant-design/icons-vue';
import { useStore } from 'vuex';
import { computed } from 'vue';

export default {

  emits: [
    'click',
  ],
  components: {
    LoadingOutlined,
  },
  props: {
    /**
     * 设置按钮类型，可选值为 **primary** / **cancel** / **inactive** / **default**
     */
    type: {
      type: String,
      default: 'default',
    },
    /**
     * 将按钮宽度调整为其父宽度的选项
     */
    block: {
      type: Boolean,
      default: false,
    },
    /**
     * 设置按钮载入状态
     */
    loading: {
      type: Boolean,
      default: false,
    },
    /**
     * 按钮失效状态
     */
    disabled: {
      type: Boolean,
      default: false,
    },
    /**
     * 自定义按钮颜色
     */
    color: {
      type: String,
      default: '',
    },
    /**
     * 自定义文字颜色
     */
    textColor: {
      type: String,
      default: '',
    },
    border: {
      type: Boolean,
      default: false,
    },
    round: {
      type: Boolean,
      default: false,
    },
  },
  setup(props, { emit }) {
    const store = useStore();
    const siteStyle = computed(() => store.getters.siteStyle);
    const click = (event) => {
      if (props.disabled || props.loading) {
        event.preventDefault();
        return;
      }
      emit('click');
    };
    return {
      click,
      siteStyle,
    };
  },
};
</script>

<style lang="scss" scoped>
@import '~@/components/DButton/mixin.scss';

.d-btn {
  @include button-bg;

  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 36px;
  padding: 0 15px;
  border-radius: 3px;
  color: #333;
  font-size: 14px;
  background: #fff;
  transition: all 0.3s ease;
  outline: 0;
  cursor: pointer;

  > .anticon + span {
    margin-left: 8px;
  }

  &.loading {
    cursor: auto;
  }

  &.block {
    width: 100%;
  }

  &.border-none {
    border: none;
  }

  &.round {
    border-radius: 20px;
  }

  &.style2 {
    border-radius: 20px;
  }
}
</style>
